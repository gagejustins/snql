!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.SearchAddon=t():e.SearchAddon=t()}(window,function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._linesCacheTimeoutId=0}return e.prototype.activate=function(e){this._terminal=e},e.prototype.dispose=function(){},e.prototype.findNext=function(e,t){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!e||0===e.length)return this._terminal.clearSelection(),!1;var i=0,n=0;if(this._terminal.hasSelection()){var r=!!t&&t.incremental,o=this._terminal.getSelectionPosition();n=r?o.startRow:o.endRow,i=r?o.startColumn:o.endColumn}this._initLinesCache();var s=this._findInLine(e,n,i,t);if(!s)for(var a=n+1;a<this._terminal.buffer.baseY+this._terminal.rows&&!(s=this._findInLine(e,a,0,t));a++);if(!s&&0!==n)for(a=0;a<n&&!(s=this._findInLine(e,a,0,t));a++);return this._selectResult(s)},e.prototype.findPrevious=function(e,t){if(!this._terminal)throw new Error("Cannot use addon until it has been loaded");if(!e||0===e.length)return this._terminal.clearSelection(),!1;var i=this._terminal.buffer.baseY+this._terminal.rows,n=this._terminal.cols,r=void 0,o=!!t&&t.incremental;if(this._terminal.hasSelection()){var s=this._terminal.getSelectionPosition();i=s.startRow,n=s.startColumn}if(this._initLinesCache(),o&&(r=this._findInLine(e,i,n,t,!1))&&r.row===i&&r.col===n||(r=this._findInLine(e,i,n,t,!0)),!r){n=this._terminal.cols;for(var a=i-1;a>=0&&!(r=this._findInLine(e,a,n,t,!0));a--);}if(!r&&i!==this._terminal.buffer.baseY+this._terminal.rows)for(a=this._terminal.buffer.baseY+this._terminal.rows;a>i&&!(r=this._findInLine(e,a,n,t,!0));a--);return this._selectResult(r)},e.prototype._initLinesCache=function(){var e=this,t=this._terminal;this._linesCache||(this._linesCache=new Array(t.buffer.length),this._cursorMoveListener=t.onCursorMove(function(){return e._destroyLinesCache()}),this._resizeListener=t.onResize(function(){return e._destroyLinesCache()})),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(function(){return e._destroyLinesCache()},15e3)},e.prototype._destroyLinesCache=function(){this._linesCache=void 0,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)},e.prototype._isWholeWord=function(e,t,i){return!(0!==e&&-1===" ~!@#$%^&*()+`-=[]{}|;:\"',./<>?".indexOf(t[e-1])||e+i.length!==t.length&&-1===" ~!@#$%^&*()+`-=[]{}|;:\"',./<>?".indexOf(t[e+i.length]))},e.prototype._findInLine=function(e,t,i,n,r){void 0===n&&(n={}),void 0===r&&(r=!1);var o=this._terminal,s=o.buffer.getLine(t);if(!s||!s.isWrapped){var a=this._linesCache?this._linesCache[t]:void 0;void 0===a&&(a=this._translateBufferLineToStringWithWrap(t,!0),this._linesCache&&(this._linesCache[t]=a));var l=n.caseSensitive?e:e.toLowerCase(),f=n.caseSensitive?a:a.toLowerCase(),u=-1;if(n.regex){var h=RegExp(l,"g"),c=void 0;if(r)for(;c=h.exec(f.slice(0,i));)u=h.lastIndex-c[0].length,e=c[0],h.lastIndex-=e.length-1;else(c=h.exec(f.slice(i)))&&c[0].length>0&&(u=i+(h.lastIndex-c[0].length),e=c[0])}else r?i-l.length>=0&&(u=f.lastIndexOf(l,i-l.length)):u=f.indexOf(l,i);if(u>=0){if(u>=o.cols&&(t+=Math.floor(u/o.cols),u%=o.cols),n.wholeWord&&!this._isWholeWord(u,f,e))return;var d=o.buffer.getLine(t);if(d)for(var _=0;_<u;_++){var p=d.getCell(_);if(!p)break;var v=p.char;v.length>1&&(u-=v.length-1),0===p.width&&u++}return{term:e,col:u,row:t}}}},e.prototype._translateBufferLineToStringWithWrap=function(e,t){var i,n=this._terminal,r="";do{var o=n.buffer.getLine(e+1);i=!!o&&o.isWrapped;var s=n.buffer.getLine(e);if(!s)break;r+=s.translateToString(!i&&t).substring(0,n.cols),e++}while(i);return r},e.prototype._selectResult=function(e){var t=this._terminal;if(!e)return t.clearSelection(),!1;if(t.select(e.col,e.row,e.term.length),e.row>t.buffer.viewportY+t.rows||e.row<t.buffer.viewportY){var i=e.row-t.buffer.viewportY;i-=Math.floor(t.rows/2),t.scrollLines(i)}return!0},e}();t.SearchAddon=n}])});
//# sourceMappingURL=xterm-addon-search.js.map